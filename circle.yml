dependencies:
  override:
    - docker info
    - docker pull mtiller/book-builder
    - docker pull node:6.2.2
test:
  override:
    - git fetch --unshallow
    - docker run -v `pwd`:/opt/MBE/ModelicaBook -i -t mtiller/book-builder make specs
    - docker run -v `pwd`:/opt/MBE/ModelicaBook -i -t mtiller/book-builder make results
    - docker run -v `pwd`:/opt/MBE/ModelicaBook -i -t mtiller/book-builder make dirhtml
    - mkdir api/models
    - tar zxf text/results/exes.tar.gz --directory api/models
    - (cd api; npm install -g dockergen && npm run image)
machine:
  services:
    - docker
  node:
    version: 6.2.2

